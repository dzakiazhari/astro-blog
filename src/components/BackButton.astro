---
import IconChevronLeft from "@/assets/icons/IconChevronLeft.svg";
import { SITE } from "@/config";

interface Props {
  class?: string;
}

const { class: className = "" } = Astro.props as Props;
---

{
  SITE.showBackButton && (
    <a
      id="back-button"
      href="/"
      class:list={[
        "inline-flex h-9 items-center gap-2 rounded-[var(--radius-xs)] border border-[var(--border-soft)] bg-transparent px-3 text-[0.68rem] font-semibold tracking-[0.24em] text-[color:var(--muted-text)] uppercase transition-colors duration-150",
        "hover:border-[color:var(--border-strong)] hover:text-[color:var(--nav-text-strong)]",
        "focus-visible:ring-2 focus-visible:ring-[color:var(--ring-accent)] focus-visible:outline-none",
        "shrink-0",
        className,
      ]}
      data-astro-prefetch="hover"
    >
      <IconChevronLeft class="inline-block size-4 rtl:rotate-180" />
      <span>Go back</span>
    </a>
  )
}

<script>
  /* Synchronize stored back-link for the "Go back" button */
  function updateGoBackUrl() {
    const backButton: HTMLAnchorElement | null =
      document.querySelector("#back-button");

    const backUrl = sessionStorage.getItem("backUrl");

    if (backUrl && backButton) {
      backButton.href = backUrl;
    }
  }

  document.addEventListener("astro:page-load", updateGoBackUrl);
  updateGoBackUrl();
</script>
