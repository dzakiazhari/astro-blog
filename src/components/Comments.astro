---
import { GISCUS } from "@/constants";

export interface Props {
  identifier: string;
  lightTheme?: string;
  darkTheme?: string;
}

const {
  identifier,
  lightTheme = "light",
  darkTheme = "dark",
} = Astro.props as Props;

const config = {
  ...GISCUS,
  term: identifier,
  lightTheme,
  darkTheme,
};
---

<div class="mt-8" data-giscus-root data-identifier={identifier}>
  <p data-giscus-placeholder class="text-sm text-foreground/60">
    Comments load when this section enters the viewport.
  </p>
  <button
    data-giscus-load
    type="button"
    class="mt-3 rounded-full border border-border/70 bg-background/80 px-4 py-2 text-xs font-medium tracking-wide text-foreground/70 uppercase transition hover:border-accent/40 hover:text-accent focus-visible:ring-2 focus-visible:ring-accent/50 focus-visible:outline-none"
  >
    Load comments now
  </button>
  <script
    is:inline
    type="application/json"
    data-giscus-config
    set:html={JSON.stringify(config)}
  />
  <noscript class="mt-2 block text-sm text-foreground/60">
    Enable JavaScript to view the comments powered by Giscus.
  </noscript>
</div>
<script
  is:inline
  defer
  data-astro-rerun
  src="/scripts/comments.js"
></script>
